<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindMate - AI Mental Health Companion</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Custom Styles -->
    <style>
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900 overflow-hidden">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'https://esm.sh/react@18.2.0?dev';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client?dev';
        import { 
            LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer 
        } from 'https://esm.sh/recharts@2.12.2?dev';
        import { 
            Heart, MessageCircle, BarChart2, BookOpen, Send, Menu, X, 
            Smile, Frown, Meh, AlertCircle, Wind, Sun, Phone 
        } from 'https://esm.sh/lucide-react@0.344.0?dev';

        // --- Firebase Imports ---
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js';
        import { 
            getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken 
        } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js';
        import { 
            getFirestore, collection, addDoc, query, orderBy, limit, onSnapshot, serverTimestamp 
        } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';

        // --- Configuration ---
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'mindmate-default';
        
        // Initialize Firebase only if config is present (prevents crash in preview without env)
        let auth, db;
        try {
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        } catch (e) {
            console.warn("Firebase not initialized (likely missing config in preview):", e);
        }

        // --- Gemini API ---
        const GEMINI_API_KEY = ""; // Injected by environment
        const GEMINI_MODEL = "gemini-2.5-flash-preview-09-2025";

        // --- Constants ---
        const MOODS = [
            { value: 1, label: "Struggling", icon: Frown, color: "text-red-500", bg: "bg-red-100" },
            { value: 2, label: "Low", icon: Meh, color: "text-orange-500", bg: "bg-orange-100" },
            { value: 3, label: "Okay", icon: Meh, color: "text-yellow-500", bg: "bg-yellow-100" },
            { value: 4, label: "Good", icon: Smile, color: "text-blue-500", bg: "bg-blue-100" },
            { value: 5, label: "Great", icon: Sun, color: "text-green-500", bg: "bg-green-100" },
        ];

        const BREATHING_EXERCISES = [
            { title: "Box Breathing", duration: "4s-4s-4s-4s", description: "Inhale 4s, Hold 4s, Exhale 4s, Hold 4s" },
            { title: "4-7-8 Relax", duration: "4s-7s-8s", description: "Inhale 4s, Hold 7s, Exhale 8s" },
        ];

        // --- Components ---

        const BreathingCircle = ({ active }) => {
            return (
                <div className="flex flex-col items-center justify-center py-12">
                    <div className={`relative flex items-center justify-center w-48 h-48 rounded-full bg-teal-100 transition-all duration-[4000ms] ease-in-out ${active ? 'scale-150 opacity-80' : 'scale-100 opacity-40'}`}>
                        <div className={`absolute w-32 h-32 bg-teal-300 rounded-full opacity-50 transition-all duration-[4000ms] ${active ? 'scale-125' : 'scale-90'}`}></div>
                        <div className="text-teal-800 font-semibold z-10">
                            {active ? "Inhale..." : "Exhale..."}
                        </div>
                    </div>
                    <p className="mt-8 text-gray-600 text-center max-w-xs">
                        Follow the circle. Breathe in as it expands, breathe out as it shrinks.
                    </p>
                </div>
            );
        };

        const ChatMessage = ({ message }) => {
            const isUser = message.role === 'user';
            return (
                <div className={`flex w-full mb-4 ${isUser ? 'justify-end' : 'justify-start'}`}>
                    <div className={`max-w-[80%] rounded-2xl px-4 py-3 shadow-sm ${
                        isUser 
                        ? 'bg-indigo-600 text-white rounded-br-none' 
                        : 'bg-white text-gray-800 border border-gray-100 rounded-bl-none'
                    }`}>
                        <p className="text-sm md:text-base whitespace-pre-wrap">{message.text}</p>
                        <span className={`text-[10px] block mt-1 ${isUser ? 'text-indigo-200' : 'text-gray-400'}`}>
                        {new Date(message.timestamp).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                        </span>
                    </div>
                </div>
            );
        };

        const LoadingBubble = () => (
            <div className="flex justify-start w-full mb-4">
                <div className="bg-white border border-gray-100 rounded-2xl rounded-bl-none px-4 py-3 shadow-sm flex space-x-1">
                    <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0s' }}></div>
                    <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
                    <div className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0.4s' }}></div>
                </div>
            </div>
        );

        // --- Main App Component ---

        const MindMateApp = () => {
            const [user, setUser] = useState(null);
            const [activeTab, setActiveTab] = useState('home');
            const [showMenu, setShowMenu] = useState(false);
            
            // Chat State
            const [messages, setMessages] = useState([
                { 
                id: 'welcome', 
                role: 'model', 
                text: "Hi, I'm MindMate. I'm here to listen without judgment. How are you feeling today?", 
                timestamp: new Date().toISOString() 
                }
            ]);
            const [inputMessage, setInputMessage] = useState('');
            const [isTyping, setIsTyping] = useState(false);
            const messagesEndRef = useRef(null);

            // Mood State
            const [selectedMood, setSelectedMood] = useState(null);
            const [journalEntry, setJournalEntry] = useState('');
            const [moodHistory, setMoodHistory] = useState([]);
            const [isSavingMood, setIsSavingMood] = useState(false);
            const [showMoodSuccess, setShowMoodSuccess] = useState(false);

            // Breathing State
            const [isBreathingActive, setIsBreathingActive] = useState(false);

            // --- Authentication ---
            useEffect(() => {
                if (!auth) return;
                
                const initAuth = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await signInWithCustomToken(auth, __initial_auth_token);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (err) {
                        console.error("Auth Error:", err);
                    }
                };
                initAuth();
                
                const unsubscribe = onAuthStateChanged(auth, (currentUser) => {
                    setUser(currentUser);
                });
                return () => unsubscribe();
            }, []);

            // --- Load Data ---
            useEffect(() => {
                if (!user || !db) return;

                const moodsRef = collection(db, 'artifacts', appId, 'users', user.uid, 'moods');
                const q = query(moodsRef, orderBy('timestamp', 'desc'), limit(30));
                
                const unsubscribeMoods = onSnapshot(q, (snapshot) => {
                    const moods = snapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data(),
                        timestamp: doc.data().timestamp?.toDate() || new Date() 
                    })).reverse(); 
                    setMoodHistory(moods);
                }, (err) => console.error("Error fetching moods:", err));

                return () => unsubscribeMoods();
            }, [user]);

            useEffect(() => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [messages, isTyping]);

            useEffect(() => {
                if (activeTab === 'mindfulness') {
                    const interval = setInterval(() => {
                        setIsBreathingActive(prev => !prev);
                    }, 4000);
                    return () => clearInterval(interval);
                }
            }, [activeTab]);

            // --- Handlers ---

            const handleSendMessage = async () => {
                if (!inputMessage.trim()) return;

                const userMsg = {
                    id: Date.now().toString(),
                    role: 'user',
                    text: inputMessage,
                    timestamp: new Date().toISOString()
                };

                setMessages(prev => [...prev, userMsg]);
                setInputMessage('');
                setIsTyping(true);

                try {
                    const history = messages.map(m => ({
                        role: m.role === 'model' ? 'model' : 'user',
                        parts: [{ text: m.text }]
                    }));

                    const systemPrompt = `You are MindMate, an empathetic, supportive, and gentle mental health companion. 
                    Your goal is to listen actively, validate feelings, and offer simple, evidence-based coping strategies (like CBT or mindfulness) when appropriate. 
                    Keep responses concise (2-3 short paragraphs max) and conversational. 
                    CRITICAL SAFETY: If the user mentions self-harm, suicide, or severe crisis, you MUST gently urge them to seek professional help immediately and provide generic emergency numbers (988 in US, 112 in EU, etc.).
                    Do not diagnose medical conditions.`;

                    const payload = {
                        contents: [...history, { role: 'user', parts: [{ text: userMsg.text }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    };

                    const response = await fetch(
                        `https://generativelanguage.googleapis.com/v1beta/models/${GEMINI_MODEL}:generateContent?key=${GEMINI_API_KEY}`,
                        {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        }
                    );

                    const data = await response.json();
                    const botText = data.candidates?.[0]?.content?.parts?.[0]?.text || "I'm having trouble connecting right now. Please try again.";

                    const botMsg = {
                        id: (Date.now() + 1).toString(),
                        role: 'model',
                        text: botText,
                        timestamp: new Date().toISOString()
                    };

                    setMessages(prev => [...prev, botMsg]);
                } catch (error) {
                    console.error("AI Error:", error);
                    setMessages(prev => [...prev, {
                        id: Date.now().toString(),
                        role: 'model',
                        text: "I'm sorry, I'm having trouble thinking right now. Let's take a deep breath and try again in a moment.",
                        timestamp: new Date().toISOString()
                    }]);
                } finally {
                    setIsTyping(false);
                }
            };

            const handleMoodSubmit = async () => {
                if (!selectedMood || !user || !db) return;
                
                setIsSavingMood(true);
                try {
                    await addDoc(collection(db, 'artifacts', appId, 'users', user.uid, 'moods'), {
                        moodValue: selectedMood.value,
                        moodLabel: selectedMood.label,
                        note: journalEntry,
                        timestamp: serverTimestamp()
                    });
                    
                    setJournalEntry('');
                    setSelectedMood(null);
                    setShowMoodSuccess(true);
                    setTimeout(() => setShowMoodSuccess(false), 3000);
                } catch (error) {
                    console.error("Error saving mood:", error);
                    alert("Failed to save mood. Please try again.");
                } finally {
                    setIsSavingMood(false);
                }
            };

            const renderNavItem = (id, label, Icon) => (
                <button
                    onClick={() => { setActiveTab(id); setShowMenu(false); }}
                    className={`flex items-center space-x-3 px-6 py-4 w-full transition-colors ${
                        activeTab === id 
                        ? 'bg-indigo-50 text-indigo-600 border-r-4 border-indigo-600' 
                        : 'text-gray-500 hover:bg-gray-50'
                    }`}
                >
                    <Icon size={20} />
                    <span className="font-medium">{label}</span>
                </button>
            );

            return (
                <div className="flex h-screen bg-gray-50 font-sans overflow-hidden">
                    
                    {/* Sidebar (Desktop) */}
                    <aside className="hidden md:flex flex-col w-64 bg-white border-r border-gray-200 h-full">
                        <div className="p-6 flex items-center space-x-2 border-b border-gray-100">
                        <div className="bg-indigo-600 p-2 rounded-lg">
                            <Heart className="text-white" size={20} />
                        </div>
                        <h1 className="text-xl font-bold text-gray-800">MindMate</h1>
                        </div>
                        
                        <nav className="flex-1 mt-6">
                        {renderNavItem('home', 'Daily Check-in', Smile)}
                        {renderNavItem('chat', 'AI Companion', MessageCircle)}
                        {renderNavItem('dashboard', 'My Progress', BarChart2)}
                        {renderNavItem('mindfulness', 'Mindfulness', Wind)}
                        {renderNavItem('resources', 'Resources', BookOpen)}
                        </nav>

                        <div className="p-6 border-t border-gray-100 bg-red-50">
                        <div className="flex items-start space-x-2 text-red-600">
                            <AlertCircle size={20} className="shrink-0 mt-0.5" />
                            <div className="text-xs">
                            <p className="font-semibold">Crisis Mode</p>
                            <p>If you are in danger, call emergency services immediately.</p>
                            </div>
                        </div>
                        </div>
                    </aside>

                    {/* Mobile Header */}
                    <div className="md:hidden fixed top-0 left-0 right-0 h-16 bg-white border-b border-gray-200 z-20 flex items-center justify-between px-4">
                        <div className="flex items-center space-x-2">
                        <div className="bg-indigo-600 p-1.5 rounded-lg">
                            <Heart className="text-white" size={18} />
                        </div>
                        <span className="font-bold text-gray-800">MindMate</span>
                        </div>
                        <button onClick={() => setShowMenu(!showMenu)} className="p-2 text-gray-600">
                        {showMenu ? <X size={24} /> : <Menu size={24} />}
                        </button>
                    </div>

                    {/* Mobile Menu Overlay */}
                    {showMenu && (
                        <div className="fixed inset-0 z-10 bg-white pt-20 md:hidden animate-fade-in">
                        <nav className="flex flex-col">
                            {renderNavItem('home', 'Daily Check-in', Smile)}
                            {renderNavItem('chat', 'AI Companion', MessageCircle)}
                            {renderNavItem('dashboard', 'My Progress', BarChart2)}
                            {renderNavItem('mindfulness', 'Mindfulness', Wind)}
                            {renderNavItem('resources', 'Resources', BookOpen)}
                        </nav>
                        </div>
                    )}

                    {/* Main Content */}
                    <main className="flex-1 flex flex-col h-full relative pt-16 md:pt-0 overflow-hidden">
                        
                        {/* -- TAB: HOME / CHECK-IN -- */}
                        {activeTab === 'home' && (
                        <div className="flex-1 overflow-y-auto p-6 md:p-10">
                            <div className="max-w-2xl mx-auto">
                            <h2 className="text-2xl md:text-3xl font-bold text-gray-800 mb-2">
                                Welcome back.
                            </h2>
                            <p className="text-gray-500 mb-8">Take a moment to reflect on how you're feeling right now.</p>

                            <div className="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8">
                                <label className="block text-sm font-medium text-gray-700 mb-4">How are you feeling?</label>
                                <div className="grid grid-cols-5 gap-2 md:gap-4 mb-8">
                                {MOODS.map((m) => (
                                    <button
                                    key={m.value}
                                    onClick={() => setSelectedMood(m)}
                                    className={`flex flex-col items-center p-3 rounded-xl transition-all ${
                                        selectedMood?.value === m.value 
                                        ? `${m.bg} ring-2 ring-offset-2 ring-indigo-500 transform scale-105` 
                                        : 'hover:bg-gray-50 grayscale hover:grayscale-0'
                                    }`}
                                    >
                                    <m.icon size={32} className={m.color} />
                                    <span className="text-xs mt-2 font-medium text-gray-600">{m.label}</span>
                                    </button>
                                ))}
                                </div>

                                <label className="block text-sm font-medium text-gray-700 mb-2">Journal (Optional)</label>
                                <textarea
                                value={journalEntry}
                                onChange={(e) => setJournalEntry(e.target.value)}
                                placeholder="What's on your mind? Vent, reflect, or just list a few thoughts..."
                                className="w-full p-4 rounded-xl border border-gray-200 focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none h-32 resize-none mb-4 text-gray-700"
                                />

                                <button
                                onClick={handleMoodSubmit}
                                disabled={!selectedMood || isSavingMood}
                                className={`w-full py-3 rounded-xl font-semibold text-white shadow-md transition-all ${
                                    !selectedMood 
                                    ? 'bg-gray-300 cursor-not-allowed' 
                                    : 'bg-indigo-600 hover:bg-indigo-700 active:scale-[0.98]'
                                }`}
                                >
                                {isSavingMood ? 'Saving...' : 'Log Check-in'}
                                </button>

                                {showMoodSuccess && (
                                <div className="mt-4 p-3 bg-green-50 text-green-700 rounded-lg text-center text-sm font-medium animate-fade-in">
                                    Check-in saved successfully!
                                </div>
                                )}
                            </div>

                            <div className="grid md:grid-cols-2 gap-4">
                                <div 
                                    onClick={() => setActiveTab('mindfulness')}
                                    className="bg-teal-50 p-6 rounded-2xl border border-teal-100 cursor-pointer hover:shadow-md transition-all"
                                >
                                    <Wind className="text-teal-600 mb-3" size={24} />
                                    <h3 className="font-semibold text-teal-900">Need to breathe?</h3>
                                    <p className="text-sm text-teal-700 mt-1">Try a quick guided box breathing exercise.</p>
                                </div>
                                <div 
                                    onClick={() => setActiveTab('chat')}
                                    className="bg-indigo-50 p-6 rounded-2xl border border-indigo-100 cursor-pointer hover:shadow-md transition-all"
                                >
                                    <MessageCircle className="text-indigo-600 mb-3" size={24} />
                                    <h3 className="font-semibold text-indigo-900">Talk it out</h3>
                                    <p className="text-sm text-indigo-700 mt-1">Chat with MindMate about whatever is bothering you.</p>
                                </div>
                            </div>
                            </div>
                        </div>
                        )}

                        {/* -- TAB: CHAT -- */}
                        {activeTab === 'chat' && (
                        <div className="flex flex-col h-full bg-white">
                            <div className="flex-1 overflow-y-auto p-4 bg-gray-50/50 scroll-smooth">
                            <div className="max-w-3xl mx-auto pb-4 pt-2">
                                <div className="text-center mb-6">
                                    <div className="inline-flex items-center justify-center w-12 h-12 rounded-full bg-indigo-100 mb-2">
                                        <Heart className="text-indigo-600" size={24} />
                                    </div>
                                    <p className="text-xs text-gray-400 uppercase tracking-wide font-semibold">MindMate AI</p>
                                    <p className="text-gray-500 text-sm">This is a safe space. Conversations are private.</p>
                                </div>
                                
                                {messages.map((msg) => (
                                    <ChatMessage key={msg.id} message={msg} />
                                ))}
                                
                                {isTyping && <LoadingBubble />}
                                <div ref={messagesEndRef} />
                            </div>
                            </div>

                            <div className="p-4 border-t border-gray-100 bg-white">
                            <div className="max-w-3xl mx-auto relative">
                                <input
                                type="text"
                                value={inputMessage}
                                onChange={(e) => setInputMessage(e.target.value)}
                                onKeyPress={(e) => e.key === 'Enter' && handleSendMessage()}
                                placeholder="Type a message..."
                                className="w-full pl-5 pr-12 py-4 bg-gray-50 rounded-2xl border-0 focus:ring-2 focus:ring-indigo-500 outline-none text-gray-700 placeholder-gray-400"
                                />
                                <button
                                onClick={handleSendMessage}
                                disabled={!inputMessage.trim() || isTyping}
                                className="absolute right-2 top-2 p-2 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 disabled:opacity-50 disabled:hover:bg-indigo-600 transition-colors"
                                >
                                <Send size={20} />
                                </button>
                            </div>
                            </div>
                        </div>
                        )}

                        {/* -- TAB: DASHBOARD -- */}
                        {activeTab === 'dashboard' && (
                        <div className="flex-1 overflow-y-auto p-6 md:p-10 bg-gray-50">
                            <div className="max-w-4xl mx-auto">
                                <h2 className="text-2xl font-bold text-gray-800 mb-6">Your Emotional Trends</h2>
                                
                                {/* Chart Card */}
                                <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 mb-6">
                                {moodHistory.length > 1 ? (
                                    <div className="h-64 w-full">
                                        <ResponsiveContainer width="100%" height="100%">
                                        <LineChart data={moodHistory}>
                                            <CartesianGrid strokeDasharray="3 3" vertical={false} stroke="#f0f0f0" />
                                            <XAxis 
                                                dataKey="timestamp" 
                                                tickFormatter={(date) => new Date(date).toLocaleDateString(undefined, {weekday: 'short'})}
                                                axisLine={false}
                                                tickLine={false}
                                                tick={{fill: '#9ca3af', fontSize: 12}}
                                                dy={10}
                                            />
                                            <YAxis 
                                                domain={[1, 5]} 
                                                ticks={[1, 2, 3, 4, 5]}
                                                tickFormatter={(val) => ['','Struggling', 'Low', 'Okay', 'Good', 'Great'][val]}
                                                axisLine={false}
                                                tickLine={false}
                                                width={60}
                                                tick={{fill: '#9ca3af', fontSize: 12}}
                                            />
                                            <Tooltip 
                                                contentStyle={{borderRadius: '12px', border: 'none', boxShadow: '0 4px 6px -1px rgb(0 0 0 / 0.1)'}}
                                                labelFormatter={(label) => new Date(label).toLocaleDateString(undefined, {weekday: 'long', month: 'short', day: 'numeric'})}
                                            />
                                            <Line 
                                                type="monotone" 
                                                dataKey="moodValue" 
                                                stroke="#4f46e5" 
                                                strokeWidth={3} 
                                                dot={{r: 4, fill: '#4f46e5', strokeWidth: 2, stroke: '#fff'}} 
                                                activeDot={{r: 6}}
                                            />
                                        </LineChart>
                                        </ResponsiveContainer>
                                    </div>
                                ) : (
                                    <div className="h-64 flex flex-col items-center justify-center text-gray-400 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200">
                                        <BarChart2 size={32} className="mb-2 opacity-50" />
                                        <p>Log a few more daily check-ins to see your trends!</p>
                                    </div>
                                )}
                                </div>

                                {/* Recent Logs List */}
                                <h3 className="text-lg font-bold text-gray-800 mb-4">Recent Entries</h3>
                                <div className="space-y-4">
                                {moodHistory.length > 0 ? (
                                    [...moodHistory].reverse().slice(0, 5).map((entry) => (
                                        <div key={entry.id} className="bg-white p-4 rounded-xl border border-gray-100 flex items-start space-x-4">
                                            <div className={`p-3 rounded-full ${
                                                entry.moodValue >= 4 ? 'bg-green-100 text-green-600' : 
                                                entry.moodValue === 3 ? 'bg-yellow-100 text-yellow-600' : 
                                                'bg-red-100 text-red-600'
                                            }`}>
                                                {entry.moodValue >= 4 ? <Smile size={24} /> : entry.moodValue === 3 ? <Meh size={24} /> : <Frown size={24} />}
                                            </div>
                                            <div>
                                                <div className="flex items-center space-x-2 mb-1">
                                                    <span className="font-semibold text-gray-800">{entry.moodLabel}</span>
                                                    <span className="text-xs text-gray-400">• {new Date(entry.timestamp).toLocaleDateString()}</span>
                                                </div>
                                                {entry.note && <p className="text-gray-600 text-sm">{entry.note}</p>}
                                            </div>
                                        </div>
                                    ))
                                ) : (
                                    <p className="text-gray-500 italic">No entries yet.</p>
                                )}
                                </div>
                            </div>
                        </div>
                        )}

                        {/* -- TAB: MINDFULNESS -- */}
                        {activeTab === 'mindfulness' && (
                        <div className="flex-1 overflow-y-auto p-6 md:p-10 bg-teal-50/30">
                            <div className="max-w-2xl mx-auto text-center">
                                <h2 className="text-2xl font-bold text-teal-900 mb-2">Breathe & Center</h2>
                                <p className="text-teal-700 mb-10">Simple exercises to calm your nervous system.</p>
                                
                                <div className="bg-white rounded-3xl shadow-sm border border-teal-100 p-8 mb-8">
                                <BreathingCircle active={isBreathingActive} />
                                </div>

                                <div className="grid gap-4 text-left">
                                    {BREATHING_EXERCISES.map((ex, idx) => (
                                        <div key={idx} className="bg-white p-5 rounded-xl border border-gray-100 hover:border-teal-200 transition-colors cursor-pointer">
                                            <div className="flex justify-between items-center mb-2">
                                                <h4 className="font-bold text-gray-800">{ex.title}</h4>
                                                <span className="text-xs font-mono bg-gray-100 px-2 py-1 rounded text-gray-600">{ex.duration}</span>
                                            </div>
                                            <p className="text-sm text-gray-600">{ex.description}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                        )}

                        {/* -- TAB: RESOURCES -- */}
                        {activeTab === 'resources' && (
                            <div className="flex-1 overflow-y-auto p-6 md:p-10 bg-gray-50">
                                <div className="max-w-3xl mx-auto">
                                    <h2 className="text-2xl font-bold text-gray-800 mb-6">Support Resources</h2>
                                    
                                    <div className="bg-red-50 border border-red-100 rounded-2xl p-6 mb-8 flex items-start space-x-4">
                                        <div className="bg-red-100 p-3 rounded-full text-red-600 shrink-0">
                                            <Phone size={24} />
                                        </div>
                                        <div>
                                            <h3 className="font-bold text-red-800 text-lg mb-1">Immediate Crisis Support</h3>
                                            <p className="text-red-700 text-sm mb-4">
                                                If you or someone you know is in immediate danger, please call emergency services or a crisis helpline immediately.
                                            </p>
                                            <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                                                <a href="#" className="bg-white text-red-600 py-2 px-4 rounded-lg text-center font-semibold border border-red-200 hover:bg-red-50 transition-colors">
                                                    988 (USA/Canada)
                                                </a>
                                                <a href="#" className="bg-white text-red-600 py-2 px-4 rounded-lg text-center font-semibold border border-red-200 hover:bg-red-50 transition-colors">
                                                    112 (Europe)
                                                </a>
                                            </div>
                                        </div>
                                    </div>

                                    <h3 className="font-bold text-gray-800 mb-4">Recommended Reading</h3>
                                    <div className="grid gap-4">
                                        {[
                                            { title: "Understanding Anxiety", type: "Article", time: "5 min read" },
                                            { title: "The Science of Sleep", type: "Video", time: "12 min" },
                                            { title: "Grounding Techniques 101", type: "Guide", time: "3 min read" },
                                            { title: "Building Resilience", type: "Podcast", time: "25 min" }
                                        ].map((item, i) => (
                                            <div key={i} className="bg-white p-4 rounded-xl border border-gray-100 hover:shadow-md transition-shadow flex justify-between items-center cursor-pointer group">
                                                <div>
                                                    <h4 className="font-semibold text-gray-800 group-hover:text-indigo-600 transition-colors">{item.title}</h4>
                                                    <span className="text-xs text-gray-400">{item.type} • {item.time}</span>
                                                </div>
                                                <BookOpen size={18} className="text-gray-300 group-hover:text-indigo-400" />
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>
                        )}

                    </main>
                </div>
            );
        };

        // Mount App
        const root = createRoot(document.getElementById('root'));
        root.render(<MindMateApp />);
    </script>
</body>
</html>